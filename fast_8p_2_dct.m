%fast 8p 2d dct from [70] A refined fast 2-D discrete cosine transform 
%algorithm with regular butterfly structure

x = [1 9 17 25 33 41 49 57;
    2 10 18 26 34 42 50 58;
    3 11 19 27 35 43 51 59;
    4 12 20 28 36 44 52 60;
    5 13 21 29 37 45 53 61;
    6 14 22 30 38 46 54 62;
    7 15 23 31 39 47 55 63;
    8 16 24 32 40 48 56 65];

x1 = [x(1); x(10); x(19); x(28); x(37); x(46); x(55); x(64)];
x2 = [x(17); x(58); x(27); x(12); x(53); x(38); x(7); x(48)];
x3 = [x(33); x(18); x(51); x(4); x(61); x(14); x(47); x(32)];
x4 = [x(49); x(26); x(3); x(20); x(45); x(62); x(39); x(16)];
x5 = [x(57); x(50); x(43); x(36); x(29); x(22); x(15); x(8)];
x6 = [x(41); x(2); x(35); x(52); x(13); x(30); x(63); x(24)];
x7 = [x(25); x(42); x(11); x(60); x(5); x(54); x(23); x(40)];
x8 = [x(9); x(34); x(59); x(44); x(21); x(6); x(31); x(56)];

k1 = dct(x1);
k2 = dct(x2);
k3 = dct(x3);
k4 = dct(x4);
k5 = dct(x5);
k6 = dct(x6);
k7 = dct(x7);
k8 = dct(x8);

%---unnorm 1d-dct begin---
k1(1) = 4*sqrt(2)*k1(1);
k2(1) = 4*sqrt(2)*k2(1);
k3(1) = 4*sqrt(2)*k3(1);
k4(1) = 4*sqrt(2)*k4(1);
k5(1) = 4*sqrt(2)*k5(1);
k6(1) = 4*sqrt(2)*k6(1);
k7(1) = 4*sqrt(2)*k7(1);
k8(1) = 4*sqrt(2)*k8(1);
for i = 2:8
    k1(i) = 4*k1(i);
    k2(i) = 4*k2(i);
    k3(i) = 4*k3(i);
    k4(i) = 4*k4(i);
    k5(i) = 4*k5(i);
    k6(i) = 4*k6(i);
    k7(i) = 4*k7(i);
    k8(i) = 4*k8(i);
end
%---unnorm 1d-dct end---

p1 = [k1(1)+k5(1); k1(2)+k5(2); k1(3)+k5(3); k1(4)+k5(4); k1(5)+k5(5); k1(6)+k5(6); k1(7)+k5(7); k1(8)+k5(8)];
p2 = [k2(1)+k6(1); k2(2)+k6(2); k2(3)+k6(3); k2(4)+k6(4); k2(5)+k6(5); k2(6)+k6(6); k2(7)+k6(7); k2(8)+k6(8)];
p3 = [k3(1)+k7(1); k3(2)+k7(2); k3(3)+k7(3); k3(4)+k7(4); k3(5)+k7(5); k3(6)+k7(6); k3(7)+k7(7); k3(8)+k7(8)];
p4 = [k4(1)+k8(1); k4(2)+k8(2); k4(3)+k8(3); k4(4)+k8(4); k4(5)+k8(5); k4(6)+k8(6); k4(7)+k8(7); k4(8)+k8(8)];
q1 = [k1(1)-k5(1); k1(2)-k5(2); k1(3)-k5(3); k1(4)-k5(4); k1(5)-k5(5); k1(6)-k5(6); k1(7)-k5(7); k1(8)-k5(8)];
q2 = [k2(1)-k6(1); k2(2)-k6(2); k2(3)-k6(3); k2(4)-k6(4); k2(5)-k6(5); k2(6)-k6(6); k2(7)-k6(7); k2(8)-k6(8)];
q3 = [k3(1)-k7(1); k3(2)-k7(2); k3(3)-k7(3); k3(4)-k7(4); k3(5)-k7(5); k3(6)-k7(6); k3(7)-k7(7); k3(8)-k7(8)];
q4 = [k4(1)-k8(1); k4(2)-k8(2); k4(3)-k8(3); k4(4)-k8(4); k4(5)-k8(5); k4(6)-k8(6); k4(7)-k8(7); k4(8)-k8(8)];

a1 = [p1(1)+p3(1); p1(2)+p3(2); p1(3)+p3(3); p1(4)+p3(4); p1(5)+p3(5); p1(6)+p3(6); p1(7)+p3(7); p1(8)+p3(8)];
a2 = [p2(1)+p4(1); p2(2)+p4(2); p2(3)+p4(3); p2(4)+p4(4); p2(5)+p4(5); p2(6)+p4(6); p2(7)+p4(7); p2(8)+p4(8)];
a3 = [p1(1)-p3(1); p1(2)-p3(2); p1(3)-p3(3); p1(4)-p3(4); p1(5)-p3(5); p1(6)-p3(6); p1(7)-p3(7); p1(8)-p3(8)];
a4 = [p2(1)-p4(1); p2(2)-p4(2); p2(3)-p4(3); p2(4)-p4(4); p2(5)-p4(5); p2(6)-p4(6); p2(7)-p4(7); p2(8)-p4(8)];
c1 = [q1(1); q1(2)+q3(8); q1(3)+q3(7); q1(4)+q3(6); q1(5)+q3(5); q1(6)+q3(4); q1(7)+q3(3); q1(8)+q3(2)];
c2 = [q2(1); q2(2)+q4(8); q2(3)+q4(7); q2(4)+q4(6); q2(5)+q4(5); q2(6)+q4(4); q2(7)+q4(3); q2(8)+q4(2)];
c3 = [q3(1); q1(8)-q3(2); q1(7)-q3(3); q1(6)-q3(4); q1(5)-q3(5); q1(4)-q3(6); q1(3)-q3(7); q1(2)-q3(8)];
c4 = [q4(1); q2(8)-q4(2); q2(7)-q4(3); q2(6)-q4(4); q2(5)-q4(5); q2(4)-q4(6); q2(3)-q4(7); q2(2)-q4(8)];

b1 = [a1(1)+a2(1); a1(2)+a2(2); a1(3)+a2(3); a1(4)+a2(4); a1(5)+a2(5); a1(6)+a2(6); a1(7)+a2(7); a1(8)+a2(8)];
b2 = [a1(1)-a2(1); a1(2)-a2(2); a1(3)-a2(3); a1(4)-a2(4); a1(5)-a2(5); a1(6)-a2(6); a1(7)-a2(7); a1(8)-a2(8)];
b3 = [a3(1); a3(2)+a4(8); a3(3)+a4(7); a3(4)+a4(6); a3(5)+a4(5); a3(6)+a4(4); a3(7)+a4(3); a3(8)+a4(2)];
b4 = [a4(1); a3(8)-a4(2); a3(7)-a4(3); a3(6)-a4(4); a3(5)-a4(5); a3(4)-a4(6); a3(3)-a4(7); a3(2)-a4(8)];
d1 = [c1(1)+c4(5); c1(2)+c4(6); c1(3)+c4(7); c1(4)+c4(8); c1(5)+c2(1); c1(6)+c2(2); c1(7)+c2(3); c1(8)+c2(4)];
d2 = [c1(5)-c2(1); c1(6)-c2(2); c1(7)-c2(3); c1(8)-c2(4); -c2(5)+c3(1); -c2(6)+c3(2); -c2(7)+c3(3); -c2(8)+c3(4)];
d3 = [c2(5)+c3(1); c2(6)+c3(2); c2(7)+c3(3); c2(8)+c3(4); c3(5)+c4(1); c3(6)+c4(2); c3(7)+c4(3); c3(8)+c4(4)];
d4 = [c3(5)-c4(1); c3(6)-c4(2); c3(7)-c4(3); c3(8)-c4(4); c1(1)-c4(5); c1(2)-c4(6); c1(3)-c4(7); c1(4)-c4(8)];

y1 = [b1(1); b1(2); b1(3); b1(4); b1(5); b1(6); b1(7); b1(8)];
y2 = [1/2*b2(1); 1/2*(b2(2)+b2(8)); 1/2*(b2(3)+b2(7)); 1/2*(b2(4)+b2(6)); b2(5); 1/2*(b2(6)-b2(4)); 1/2*(b2(7)-b2(3)); 1/2*(b2(8)-b2(2))];
y3 = [1/2*(b3(1)+b4(5)); 1/2*(b3(2)+b4(4)); 1/2*(b3(3)+b4(3)); 1/2*(b3(4)+b4(2)); 1/2*(b3(5)+b4(1)); 1/2*(b3(6)+b3(8)); b3(7); 1/2*(b3(6)-b3(8))];
y4 = [1/2*(b3(5)-b4(1)); 1/2*(b3(4)-b4(2)); 1/2*(b3(3)-b4(3)); 1/2*(b3(2)-b4(4)); 1/2*(b3(1)-b4(5)); 1/2*(b4(6)-b4(8)); b4(7); 1/2*(b4(6)+b4(8))];
y5 = [1/2*(d1(1)+d3(7)); 1/2*(d1(2)+d3(6)); 1/2*(d1(3)+d4(1)); 1/2*(d1(4)+d2(8)); 1/2*(d1(5)+d2(7)); 1/2*(d1(6)+d2(6)); 1/2*(d1(7)+d3(1)); d1(8)];
y6 = [1/2*(d2(1)-d4(7)); 1/2*(d2(2)-d4(6)); 1/2*(d2(3)-d4(5)); 1/2*(d2(4)-d4(4)); 1/2*(d2(5)-d4(3)); 1/2*(d1(6)-d2(6)); 1/2*(d1(5)-d2(7)); 1/2*(d1(4)-d2(8))];
y7 = [1/2*(d1(7)-d3(1)); 1/2*(d3(2)-d4(2)); 1/2*(d3(3)-d3(5)); d3(4); 1/2*(d3(5)+d3(3)); 1/2*(d1(2)-d3(6)); 1/2*(d1(1)-d3(7)); d3(8)];
y8 = [1/2*(d1(3)-d4(1)); 1/2*(d3(2)+d4(2)); 1/2*(d2(5)+d4(3)); 1/2*(d2(4)+d4(4)); 1/2*(d2(3)+d4(5)); 1/2*(d2(2)+d4(6)); 1/2*(d2(1)+d4(7)); d4(8)];

y = 2*[y1(1) y7(8) y4(7) y8(8) y2(5) y7(4) y3(7) y5(8);
    y1(2)	y5(1)	y4(8)	y8(7)	y2(4)	y7(5)	y3(6)	y5(7);
    y1(3)	y5(2)	y3(1)	y8(6)	y2(3)	y8(2)	y3(5)	y6(6);
    y1(4)	y5(3)	y3(2)	y8(5)	y2(2)	y6(5)	y4(2)	y6(7);
    y1(5)	y5(4)	y3(3)	y8(4)	y2(1)	y6(4)	y4(3)	y6(8);
    y1(6)	y5(5)	y3(4)	y8(3)	y2(8)	y6(3)	y4(4)	y8(1);
    y1(7)	y5(6)	y4(1)	y7(2)	y2(7)	y6(2)	y4(5)	y7(6);
    y1(8)	y7(1)	y3(8)	y7(3)	y2(6)	y6(1)	y4(6)	y7(7)]

%dd = dct2(x)